{% extends 'main.html' %}
{% block content %}

<style>
    body {
        margin: 0;
        padding: 0;
        background-color: #000;
        font-family: sans-serif;
        color: white;
    }

    .reel-list {
        height: 100vh;
        overflow-y: scroll;
        scroll-snap-type: y mandatory;
    }

    .reel {
        height: 100vh;
        width: 100%;
        scroll-snap-align: start;
        position: relative;
        background: #000;
        display: flex;
        justify-content: center;
        align-items: center;
    }

    video, img {
        width: 100%;
        height: 100%;
        object-fit: cover;
    }

    .caption {
        position: absolute;
        bottom: 16px;
        left: 14px;
        z-index: 2;
    }

    @media (min-width: 992px) {
        .reel {
            max-width: 420px;
            margin: auto;
        }
    }
</style>

<div class="reel-list" id="reelContainer">
    {% for reel in reels %}
        <div class="reel">
            {% if reel.video %}
                <video autoplay muted loop playsinline>
                    <source src="{{ reel.video.url }}"  controls type="video/mp4">
                </video>
            {% elif reel.image %}
                <img src="{{ reel.image.url }}" alt="">
            {% endif %}
            <div class="caption">
                <strong>{{ reel.captions }}</strong>
                <small>{{ reel.date|date:"M d, Y H:i" }}</small>
            </div>
        </div>
    {% endfor %}
</div>

<script>
const container = document.getElementById('reelContainer');
let isScrolling = false;

container.addEventListener('wheel', (e) => {
    if (isScrolling) return;
    e.preventDefault();
    isScrolling = true;

    const reelHeight = window.innerHeight;
    if (e.deltaY > 0) {
        container.scrollBy({ top: reelHeight, left: 0, behavior: 'smooth' });
    } else {
        container.scrollBy({ top: -reelHeight, left: 0, behavior: 'smooth' });
    }

    setTimeout(() => { isScrolling = false; }, 700);
}, { passive: false });
</script>

{% endblock %}
